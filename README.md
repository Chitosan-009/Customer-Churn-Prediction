# Customer Churn Prediction

本项目基于 Kaggle Telecom Churn 数据集，通过端到端的机器学习流程构建高精度客户流失预测模型。

项目重点在于 可解释、可落地、可复现、可指导运营策略的流失预测体系。
##  项目背景
电信运营商普遍面临：
- 新用户获取成本高。
- 客户流失率持续上升。
- 资费敏感性强、竞争激烈。
- 用户套餐与实际需求不匹配。

本项目旨在通过数据建模实现：
- 精准识别高流失风险用户。
- 找到导致流失的关键驱动因素。
- 为运营提供量化、可执行的干预策略。
- 提升用户生命周期价值（CLV）。
##  数据来源与内容
- 数据来源：Kaggle Telecom Churn Dataset
- 训练数据集包含4250个样本。19 个特征 + 目标变量 churn
- 主要变量包括：
  - 用户基本信息（state、area_code）
  - 套餐类型（international_plan、voice_mail_plan）
  - 通话行为特征（日/晚/夜通话分钟数、费用、次数）
  - 客服行为（customer service calls）

##  数据清洗与分析
- 检查缺失值、重复值、异常值并处理；
- 进行单变量与多变量分析，探索特征与流失率的关系；
- 对分类变量绘制分布图，对连续变量进行分箱（binning）与分组统计；
- 业务洞察：
  - 客服呼叫 ≥4 次的用户流失率显著提升，客户体验问题明显，是强流失信号；
  - 高话费用户流失率更高（约 27%），账单与套餐不匹配，费用敏感；
  - 开通国际套餐的用户流失率 32%（未开通用户仅 11%），需优化套餐服务；
  - 开通语音邮件套餐的用户流失率最低（ 8%），稳定用户群，对服务认可度高。

##  特征工程
- 自定义分箱函数生成分箱特征；
- 构造衍生特征（费用占比、通话稳定性、国际使用频率等）；
- One-hot 编码与标准化；
- 训练集 / 测试集划分并保持分布一致性；
- 保存分箱规则与编码映射，保证推理阶段一致性。

##  模型构建与评估
使用多种模型进行对比与调优：
| 模型 | ROC-AUC | 优势 |
|------|----------------|------|
| Logistic Regression | 0.809000 | 可解释性强，作为基准模型|
| Random Forest | 0.904100 | 稳定，高可解释性 |
| XGBoost | 0.923000 | 泛化能力好，性能强 |
| LightGBM | 0.929100 | 最优 AUC，训练速度快 |

- 使用GridSearchCV、RandomizedSearchCV进行超参数调优；
- 采用 5-Fold Cross Validation 验证模型稳定性；
- 输出混淆矩阵、ROC 曲线、重要特征排序；
- 保存最佳模型用于预测。

##  关于时间维度与模型适用性的说明
本项目基于用户当前的静态行为与消费特征构建流失预测模型，未引入显式时间序列数据。

该建模方式在真实业务中具有明确适用场景，如：
- 数据基础尚未完全建设完成的阶段；
- 作为流失预警系统的第一版快速上线方案；
- 用于高风险用户的初步筛选与排序。
模型在 Kaggle 独立测试集上取得较高 AUC，验证了在当前特征条件下模型具备良好的区分能力。

在真实业务中，若引入用户行为趋势特征，模型可进一步升级为动态流失预警模型。
##  模型解释与业务建议
输出内容包括：
- 用户级流失概率（churn_probability）
- 流失风险等级（低 / 中 / 高 / 极高）
- 主要流失原因（基于 SHAP 解释）
示例输出：
| 模型customer_id	| churn_probability	| risk_level	| top_reasons |
CUST_102	0.92	极高风险	customer_service_calls(增加); monthly_charges(增加)
CUST_211	0.67	高风险	international_plan(增加); total_charges(增加)

注：模型输出概率主要用于风险排序与分级，作为运营决策参考，而非严格意义上的真实发生概率。
- 使用逻辑回归系数 / 树模型特征重要度分析影响因素；
- 对流失用户画像建模；
- 主要建议：
  1. 针对客服呼叫频繁客户建立自动跟进机制；
  2. 为国际套餐用户提供轻量级优惠；
  3. 优化高额账单客户服务体验；
  4. 建立流失预警评分系统。

## 运行方式
```bash
# 环境安装
pip install -r requirements.txt

# 运行方式1
1. Visualization_Analysis.py（数据清洗与分析）
2. Data_Preprocessing.py
3. Training_Model.py

# 运行方式2
churn_prediction.ipynb
