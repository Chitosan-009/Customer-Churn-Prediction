# Customer Churn Prediction

###  项目背景
在电信行业中，客户流失率直接影响收入稳定性和获客成本。提前识别高流失风险用户并进行针对性挽留，能够显著提升用户留存率和运营效率。 

本项目基于真实电信用户行为与消费数据，构建客户流失预测模型，并将模型结果转化为运营部门可直接使用的客户流失风险名单，支持实际业务决策。
### 项目目标
新用户获取成本持续上升，客户流失率对收入稳定性影响显著，用户对资费高度敏感，套餐同质化严重套餐，设计与用户实际使用行为存在不匹配问题等是运营商当前面临的挑战。

本项目旨在：

- 提前识别未来一段时间内的高流失风险用户；
- 定位导致用户流失的关键行为与服务因素；
- 为运营与客服团队提供可执行的用户干预依据；
- 辅助提升用户生命周期价值（CLV）。
###  数据来源与内容
- 数据来源：Kaggle Telecom Churn Dataset
- 训练数据集包含4250个样本。19 个特征 + 目标变量 churn
- 主要变量包括：
  - 用户基本信息（state、area_code）
  - 套餐类型（international_plan、voice_mail_plan）
  - 通话行为特征（日/晚/夜通话分钟数、费用、次数）
  - 客服行为（customer service calls）
###  数据清洗与分析
- 检查缺失值、重复值、异常值并处理；
- 进行单变量与多变量分析，探索特征与流失率的关系；
- 对分类变量绘制分布图，对连续变量进行分箱（binning）与分组统计；
- 业务洞察：
  - 客服呼叫 ≥4 次的用户流失率显著提升，客户体验问题明显，是强流失信号；
  - 高话费用户流失率更高（约 27%），账单与套餐不匹配，费用敏感；
  - 开通国际套餐的用户流失率 32%（未开通用户仅 11%），需优化套餐服务；
  - 开通语音邮件套餐的用户流失率最低（ 8%），稳定用户群，对服务认可度高。

###  特征工程
- 自定义分箱函数生成分箱特征；
- 构造衍生特征（费用占比、通话稳定性、国际使用频率等）；
- One-hot 编码与标准化；
- 训练集 / 测试集划分并保持分布一致性；
- 保存分箱规则与编码映射，保证推理阶段一致性。

###  模型构建与评估
使用多种模型进行对比与调优：

| 模型                  | ROC-AUC | 说明              |
| ------------------- |---------| --------------- |
| Logistic Regression | 0.8090  | 作为基准模型，具备良好可解释性 |
| Random Forest       | 0.9041  | 稳定性强，特征解释能力好    |
| XGBoost             | 0.9230  | 泛化能力强，性能优异      |
| LightGBM            | 0.9291  | 最优模型，兼顾效果与效率    |
- 使用 GridSearchCV、RandomizedSearchCV 超参数调优；
- 采用 5-Fold Cross Validation 验证模型稳定性；
- 输出混淆矩阵、ROC 曲线、重要特征排序；
- 保存最佳模型用于预测。
##  模型解释与业务建议
 输出内容包括：

- churn_probability（用户级流失概率）
- risk_level（流失风险等级）
- top_reasons （主要流失原因）

输出示例：

| customer_id | churn_probability | risk_level | top_reasons                                     |
|-------------|-------------------|------------| ----------------------------------------------- |
| CUST_102    | 0.92              | 极高风险       | customer_service_calls(增加); monthly_charges(增加) |
| CUST_211    | 0.67              | 高风险        | international_plan(增加); total_charges(增加)       |
###### 注：模型输出概率主要用于风险排序与分级，作为运营决策参考，而非严格意义上的真实发生概率。
该模型输出可直接支持：
- 客服团队优先联系高风险用户进行挽留；
- 针对不同风险等级制定差异化优惠策略；
- 作为客户流失预警评分系统的基础模块；
- 为管理层提供客户流失结构与驱动因素分析。


## 运行方式
```bash
# 环境安装
pip install -r requirements.txt

# 方式1（模块化运行）
1. Visualization_Analysis.py（数据清洗与分析）
2. Data_Preprocessing.py（数据预处理与特征工程）
3. Training_Model.py（训练模型）

# 运行方式2（Jupyter Notebook）
churn_prediction.ipynb（完整流程）
